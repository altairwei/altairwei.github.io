<?xml version="1.0" encoding="utf-8"?>
<feed xmlns="http://www.w3.org/2005/Atom">
  <title>Altair&#39;s Blog</title>
  
  <subtitle>Altair&#39;s blog</subtitle>
  <link href="https://www.altairwei.top/atom.xml" rel="self"/>
  
  <link href="https://www.altairwei.top/"/>
  <updated>2021-12-12T04:11:30.451Z</updated>
  <id>https://www.altairwei.top/</id>
  
  <author>
    <name>Altair Wei</name>
    
  </author>
  
  <generator uri="https://hexo.io/">Hexo</generator>
  
  <entry>
    <title>使用 IGV 判断链特异性建库的方式</title>
    <link href="https://www.altairwei.top/2019/09/24/use-igv-to-determine-the-type-of-stranded-specific-library/"/>
    <id>https://www.altairwei.top/2019/09/24/use-igv-to-determine-the-type-of-stranded-specific-library/</id>
    <published>2019-09-24T05:43:54.000Z</published>
    <updated>2021-12-12T04:11:30.451Z</updated>
    
    <content type="html"><![CDATA[<p>已经有一些工具可以根据已有测序数据推断测序文库的链特异性，比如 <a href="https://chipster.csc.fi/manual/rseqc_infer_rnaseq_experiment.html">RseQC</a> 。RseQC 从 FASTQ 文件中抽取少量的 reads 比对到参考基因组上，从而推断测序文库的链特异性。另外，你也可以自己抽取少量的 reads 然后使用不同的参数直接运行 HISAT2 比对，然后使用 HTSeq 计算 counts ，这样就能直接比较了。</p><h2 id="1-分子生物学概念"><a href="#1-分子生物学概念" class="headerlink" title="1 分子生物学概念"></a>1 分子生物学概念</h2><h3 id="1-1-正链（forword-strand）与反链（reverse-strand）"><a href="#1-1-正链（forword-strand）与反链（reverse-strand）" class="headerlink" title="1.1 正链（forword strand）与反链（reverse strand）"></a>1.1 正链（forword strand）与反链（reverse strand）</h3><p>这组概念是相对的，它们指互补的两条核算链，至于谁是正链，谁是反链，人为决定。但就一个给定的参考基因组而言，研究者给出的那个链就是所谓的正链（forword），另一条链是反链（reverse）。</p><h3 id="1-2-正义链（sense-strand）与反义链（antisense-strand）"><a href="#1-2-正义链（sense-strand）与反义链（antisense-strand）" class="headerlink" title="1.2 正义链（sense strand）与反义链（antisense strand）"></a>1.2 正义链（sense strand）与反义链（antisense strand）</h3><p>两条互补的 DNA 链，其中一条携带编码蛋白质信息的链称为正义链，另一条与之互补的称为反义链。回顾一下中心法则，我们就可以发现，所谓 “编码蛋白质信息” 即指 RNA 的编码区，也就是说 RNA 编码区的序列与 DNA 正义链编码区的序列是一致的。因此，正义链的信息与 RNA 链的信息是等价的。在 RNA 转录过程中，DNA 反义链作为模板指导 RNA 合成。</p><p>在本文中，我们做一个约定：我们知道用于 RNA-Seq 的 mRNA 都是单链，而且包含蛋白质编码信息。那么以 mRNA 模板反转录出的第一链 cDNA 就可以称之为反义链，因此本文会把第一链 cDNA 和反义链混着用，你们需要记住两者是指同一个意思。相对的，第二链 cDNA 可以称之为正义链，因为它的序列与 mRNA 相同，包含着蛋白质编码信息。</p><h3 id="1-3-正链基因与反链基因"><a href="#1-3-正链基因与反链基因" class="headerlink" title="1.3 正链基因与反链基因"></a>1.3 正链基因与反链基因</h3><p>这两个概念仅用于本片文章。正链基因是指 RNA 转录方向与正链方向相同的基因，即基因的正义链与基因组的正链相同。反链基因是指 RNA 转录方向与反链相同的基因，即基因的正义链与基因组反链相同。</p><h2 id="2-Illumina-建库与测序原理"><a href="#2-Illumina-建库与测序原理" class="headerlink" title="2 Illumina 建库与测序原理"></a>2 Illumina 建库与测序原理</h2><h3 id="2-1-测序接头的功能"><a href="#2-1-测序接头的功能" class="headerlink" title="2.1 测序接头的功能"></a>2.1 测序接头的功能</h3><p>测序接头的本质是一段短的碱基序列，基本包括三个部分：</p><ol><li><p>与 flow-cell 上面寡核苷酸相同或互补的片段 P5 和 P7 ；</p></li><li><p>测序时测序引物结合部分 Rd1 SP 和 Rd2 SP ；</p></li><li><p>用于区分不同样本的 Index ；</p></li></ol><p>接头是待测DNA片段与Flow-cell连接的桥梁，目的片段连接接头后可以在flow cell上扩增再测序。</p><p><img src="Snipaste_2019-09-25_14-10-20.png"></p><h3 id="2-2-TA-克隆法添加测序接头"><a href="#2-2-TA-克隆法添加测序接头" class="headerlink" title="2.2 TA 克隆法添加测序接头"></a>2.2 TA 克隆法添加测序接头</h3><p>TA克隆加接头建库的方法是目前应用最广泛的建库技术，简单描述就是：将提取好的DNA片段化或者反转录的 cDNA，进行末端修复和加A尾，然后连接上接头（adapter），最后通过PCR扩增（可选），中间再穿插着纯化/分选步骤就完成了文库的构建。在这里，提前合成好的带T尾接头和末端带A的目的片段在DNA连接酶的作用下通过TA克隆方式连接（图1）。</p><p><img src="0_3.jpg" alt="图1"></p><p>从原理图我们可以发现，RNA 反转录后的 cDNA ，正义链和反义链都被加上接头进入测序仪了。但问题在于，为什么 “Only two of four species go to the sequencer” ？</p><p>Illumina TrueSeq 文库制备流程如下：</p><ol><li>捕获带有 polyA 的 mRNA 并片段化。</li><li>合成第一链 cDNA，即合成反义链。</li><li>合成第二链 cDNA，即合成正义链。如果需要连特异性建库，那么会在这一步用 dUTP 代替 dTTP 。</li><li>在双链 cDNA 的 3’ 端添加一个碱基 A 。</li><li>在 cDNA 两端加上接头。接头的种类有单端 index、双端 index 以及无 index 的通用接头。</li><li>富集 DNA 片段。在此步，如果使用了 dUTP，那么含有 U 的链（第二链 cDNA）的聚合酶链式反应就会终止。</li><li>最终的文库，P5 接头在 5’ 端，P7 接头在 3’ 端。一条双链 cDNA 的方向由其正义链或者反义链的方向决定。对 dUTP 建库来说，P5 在反义链的 5’ 端。</li></ol><h3 id="2-3-dUTP-链特异性建库"><a href="#2-3-dUTP-链特异性建库" class="headerlink" title="2.3 dUTP 链特异性建库"></a>2.3 dUTP 链特异性建库</h3><p>在非连特异性建库的 “富集 DNA 片段” 这一步中，如果没有使用 dUTP 终止第二链 cDNA 的聚合酶链式反应，那么扩增富集后带有测序接头的双链 cDNA 有两种类型：来源于第一链 cDNA 的 ds cDNA，以及来源于第二链 cDNA 的 ds cDNA 。这两种类型的 ds cDNA 混在一起，导致我们无法区分测序结果</p><p>与常规的 TA 克隆加接头建库的方法相比，dUTP 链特异性建库会导致反转录的 cDNA 其中正义链降解掉了。也就是说，最后的 insert DNA fragment 都来自第一条合成的 cDNA （first-strand cDNA），即反义链。因此，这种类型叫做 fr-firststrand 。</p><p><img src="13101_2012_Article_35_Fig1_HTML.png" alt="图2"></p><p>我们从图二开始理解这个过程。红色的接头是 P5 ，read 1 从这里开始测序；蓝色的接头是 P7，read 2 从这里开始测序。从第 7 步 “dUTP strand degradation” 我们可以了解到，只有 RNA 反转录的第一链 cDNA （即反义链） 保留下来了。在加上 barcode 之后，上级测序。因为红色的 P5 接头上有 Rd1 sp ，因此我们可以知道 read 1 序列与 first-strand cDNA 序列已知，也就是说 read 1 是反义链。</p><h3 id="2-4-Paired-reads-的方向性"><a href="#2-4-Paired-reads-的方向性" class="headerlink" title="2.4 Paired reads 的方向性"></a>2.4 Paired reads 的方向性</h3><h4 id="为什么说-Paired-reads-具有方向性"><a href="#为什么说-Paired-reads-具有方向性" class="headerlink" title="为什么说 Paired reads 具有方向性"></a>为什么说 Paired reads 具有方向性</h4><p>Read 1 序列能够比对到反义链。</p><p><img src="Snipaste_2019-09-25_14-34-12.png" alt="Read_1"></p><p>Read 2 序列能够比对到正义链。</p><p><img src="Snipaste_2019-09-25_14-35-23.png" alt="Read_2"></p><h4 id="测序文库的分类"><a href="#测序文库的分类" class="headerlink" title="测序文库的分类"></a>测序文库的分类</h4><p>根据链特异性建库方式的不同，测序文库可以分为下图中的三类。</p><p><img src="library-type-pic1.png" alt="library-type-pic1"></p><p>图中，“fr” 的含义是 fragment ，即 insert DNA fragment 。“firststrand” 和 “secondstrand” 很好理解，这个 DNA 片段来着第一链 cDNA 还是第二链 cDNA 。“/1” 和 “/2” 的分别代表着 read 1 和 read 2 ，</p><p>那么，测序文库类型就可以分成：</p><ol><li><p>“fr-firststrand”：insert DNA fragment 来自第一链 cDNA ；比如 dUTP 链特异性建库。</p><p> 这种建库类型，read 1 能够比对到反义链，read 2 能够比对到正义链。在 IGV 中，比对到正链基因的 read pair 方向性应该是 R1F2 或者 R2F1 ，比对到反链基因的 read pair 方向性 F1R2 或者 R2F1 。</p></li><li><p>“fr-secondstrand”：insert DNA fragment 来自第二链 cDNA；比如标准的 SOLiD 建库法。</p><p> 这种建库类型，read 1 能够比对到反义链，read 2 能够比对到正义链。</p></li><li><p>“fr-unstranded”：无法区分 insert DNA fragment，即非链特异性建库；比如标准的 Illumina 建库法。</p></li></ol><h2 id="3-用-IGV-判断测序文库的链特异性"><a href="#3-用-IGV-判断测序文库的链特异性" class="headerlink" title="3 用 IGV 判断测序文库的链特异性"></a>3 用 IGV 判断测序文库的链特异性</h2><h3 id="3-1-以正链和负链的方向来决定-reads-颜色"><a href="#3-1-以正链和负链的方向来决定-reads-颜色" class="headerlink" title="3.1 以正链和负链的方向来决定 reads 颜色"></a>3.1 以正链和负链的方向来决定 reads 颜色</h3><p>IGV 中 bam 文件所在的 track 可以给每条 reads 指定不同颜色，因此我们可以利用 “Color aligments by read strand” 设置将 reads 分成粉红和淡蓝两种颜色。</p><ul><li>所有与正链方向相同的 reads 被标记为粉红色。</li><li>所有与负链方向相同的 reads 被标记为淡蓝色。</li><li>灰色的 reads 未配对的或者另一条 read 未比对上的 reads 。</li></ul><h3 id="3-2-以-Pair-orientation-来决定-reads-颜色"><a href="#3-2-以-Pair-orientation-来决定-reads-颜色" class="headerlink" title="3.2 以 Pair orientation 来决定 reads 颜色"></a>3.2 以 Pair orientation 来决定 reads 颜色</h3><p>给定一个 read pair ，如果 read 1 与正链方向相同（即 read 1 = forward read），我们将它标记为 F1，这个记号可以理解为 “Forward read is first read”。确定 read 1 的记号为 F1 后，这个给定 read pair 中的 read 2 方向必然与反链方向相同（即 read 2 = reverse read），我们将它标记为 R2，可以理解为 “Reverse read is second read”。这样，我们就知道这个给定 read pair 的 pair orientation 就是 “F1R2” 或者 “R2F1” 。两种表示方法的含义相同，区别在于你查看的对象是 read 1 还是 read 2。</p><p>给定一个 read pair，如果 read 1 与负链方向相同，我们将它标记为 R1 。确定 read 1 记号后，read 2 的记号就可以确定为 F2。那么这个给定 read pair 的 pair orientation 就是 “R1F2” 或者 “F2R1” 。</p><p>实际上 Pair orientatin 就代表着这个 read pair 是从哪条链合成出来的。</p><h3 id="3-3-dUTP-链特异性建库的特征"><a href="#3-3-dUTP-链特异性建库的特征" class="headerlink" title="3.3 dUTP 链特异性建库的特征"></a>3.3 dUTP 链特异性建库的特征</h3><p>正链基因：Read 1 与 mRNA 正义链相同，Read 2 与反义链相同。所以，正链基因是 F1R2 或者 R2F1</p><p>反链基因：F2R1 或者 R1F2</p><h2 id="4-一个复杂的示例：aRNA-Seq"><a href="#4-一个复杂的示例：aRNA-Seq" class="headerlink" title="4 一个复杂的示例：aRNA-Seq"></a>4 一个复杂的示例：aRNA-Seq</h2><p>aRNA 是 anti-RNA ，是 mRNA 的反义链。</p><p>如果我们使用体外转录的手段扩增微量 mRNA ，那么我们最终拿到的产物的 aRNA，即反义 RNA (anti-RNA) 。那么，我们使用 dUTP 链特异性建库时，第一链 cDNA 实际上是正义链，这正好与普通 mRNA dUTP 建库相反。也就是说，aRNA-Seq 使用 dUTP 的方法获得的测序文库，真正的链特异性是 “fr-secondstrand” 。</p><p><img src="Reverse_Strand_Gene.png" alt="Reverse_Strand_Gene"></p><p><img src="Forward_Strand_Gene.png" alt="Forward_Strand_Gene"></p><p>通过上面两图我们可以发现，比对到正链基因的 read pair 的方向性是 F1R2，比对到负链基因的 read pair 的方向性是 F2R1 。这个特征与 “fr-secondstrand” 文库类型匹配。</p><h2 id="参考资料"><a href="#参考资料" class="headerlink" title="参考资料"></a>参考资料</h2><ol><li>Directional RNA-seq data -which parameters to choose? <a href="https://chipster.csc.fi/manual/library-type-summary.html">https://chipster.csc.fi/manual/library-type-summary.html</a></li></ol>]]></content>
    
    
    <summary type="html">&lt;p&gt;已经有一些工具可以根据已有测序数据推断测序文库的链特异性，比如 &lt;a href=&quot;https://chipster.csc.fi/manual/rseqc_infer_rnaseq_experiment.html&quot;&gt;RseQC&lt;/a&gt; 。RseQC 从 FASTQ 文件中抽取少量的 reads 比对到参考基因组上，从而推断测序文库的链特异性。另外，你也可以自己抽取少量的 reads 然后使用不同的参数直接运行 HISAT2 比对，然后使用 HTSeq 计算 counts ，这样就能直接比较了。&lt;/p&gt;
&lt;h2 id=&quot;1-分子生物学概念&quot;&gt;&lt;a href=&quot;#1-分子生物学概念&quot; class=&quot;headerlink&quot; title=&quot;1 分子生物学概念&quot;&gt;&lt;/a&gt;1 分子生物学概念&lt;/h2&gt;&lt;h3 id=&quot;1-1-正链（forword-strand）与反链（reverse-strand）&quot;&gt;&lt;a href=&quot;#1-1-正链（forword-strand）与反链（reverse-strand）&quot; class=&quot;headerlink&quot; title=&quot;1.1 正链（forword strand）与反链（reverse strand）&quot;&gt;&lt;/a&gt;1.1 正链（forword strand）与反链（reverse strand）&lt;/h3&gt;&lt;p&gt;这组概念是相对的，它们指互补的两条核算链，至于谁是正链，谁是反链，人为决定。但就一个给定的参考基因组而言，研究者给出的那个链就是所谓的正链（forword），另一条链是反链（reverse）。&lt;/p&gt;
&lt;h3 id=&quot;1-2-正义链（sense-strand）与反义链（antisense-strand）&quot;&gt;&lt;a href=&quot;#1-2-正义链（sense-strand）与反义链（antisense-strand）&quot; class=&quot;headerlink&quot; title=&quot;1.2 正义链（sense strand）与反义链（antisense strand）&quot;&gt;&lt;/a&gt;1.2 正义链（sense strand）与反义链（antisense strand）&lt;/h3&gt;&lt;p&gt;两条互补的 DNA 链，其中一条携带编码蛋白质信息的链称为正义链，另一条与之互补的称为反义链。回顾一下中心法则，我们就可以发现，所谓 “编码蛋白质信息” 即指 RNA 的编码区，也就是说 RNA 编码区的序列与 DNA 正义链编码区的序列是一致的。因此，正义链的信息与 RNA 链的信息是等价的。在 RNA 转录过程中，DNA 反义链作为模板指导 RNA 合成。&lt;/p&gt;
&lt;p&gt;在本文中，我们做一个约定：我们知道用于 RNA-Seq 的 mRNA 都是单链，而且包含蛋白质编码信息。那么以 mRNA 模板反转录出的第一链 cDNA 就可以称之为反义链，因此本文会把第一链 cDNA 和反义链混着用，你们需要记住两者是指同一个意思。相对的，第二链 cDNA 可以称之为正义链，因为它的序列与 mRNA 相同，包含着蛋白质编码信息。&lt;/p&gt;
&lt;h3 id=&quot;1-3-正链基因与反链基因&quot;&gt;&lt;a href=&quot;#1-3-正链基因与反链基因&quot; class=&quot;headerlink&quot; title=&quot;1.3 正链基因与反链基因&quot;&gt;&lt;/a&gt;1.3 正链基因与反链基因&lt;/h3&gt;&lt;p&gt;这两个概念仅用于本片文章。正链基因是指 RNA 转录方向与正链方向相同的基因，即基因的正义链与基因组的正链相同。反链基因是指 RNA 转录方向与反链相同的基因，即基因的正义链与基因组反链相同。&lt;/p&gt;
&lt;h2 id=&quot;2-Illumina-建库与测序原理&quot;&gt;&lt;a href=&quot;#2-Illumina-建库与测序原理&quot; class=&quot;headerlink&quot; title=&quot;2 Illumina 建库与测序原理&quot;&gt;&lt;/a&gt;2 Illumina 建库与测序原理&lt;/h2&gt;</summary>
    
    
    
    <category term="Bioinformatics" scheme="https://www.altairwei.top/categories/Bioinformatics/"/>
    
    
    <category term="IGV" scheme="https://www.altairwei.top/tags/IGV/"/>
    
    <category term="RNA-Seq" scheme="https://www.altairwei.top/tags/RNA-Seq/"/>
    
  </entry>
  
  <entry>
    <title>UEFI/GPT 模式下使用 rEFInd 引导 Win10 &amp; Linux 双系统的方案</title>
    <link href="https://www.altairwei.top/2018/10/31/win-linux-dual-system/"/>
    <id>https://www.altairwei.top/2018/10/31/win-linux-dual-system/</id>
    <published>2018-10-30T16:00:00.000Z</published>
    <updated>2021-12-12T04:11:30.455Z</updated>
    
    <content type="html"><![CDATA[<p>此文最早由我在<a href="https://www.jianshu.com/p/90dca469e8f8">简书</a>发表，现搬运到本人博客。</p><blockquote><p>写这篇文章的初衷在于网络上关于 Windows 和 Linux 双系统的安装大多停留在 BIOS/MBR 时代，而现在计算主板主要为 UEFI/GPT 的架构。本文假设读者已经重装过几次 Windows 系统，对计算机基础知识有一定了解，知道如何进入 BIOS，知道如何对硬盘进行分区。如果在阅读本文过程中遇到不太熟悉的概念，请务必先自行搜索并查阅相关资料。本文不提供 Win10 安装方法，以下内容默认用户电脑已安装 Win10 系统。</p></blockquote><h2 id="一、Win10-准备工作"><a href="#一、Win10-准备工作" class="headerlink" title="一、Win10 准备工作"></a>一、Win10 准备工作</h2><h3 id="1-禁用快速启动"><a href="#1-禁用快速启动" class="headerlink" title="1. 禁用快速启动"></a>1. 禁用快速启动</h3><p>“快速启动” 是 Windows 8 时代引进的新特性，快速启动会关闭用户会话，但不再关闭内核会话，而是将其休眠。关机后部分系统数据以低电压加载至内存，开机时直接从内存调用。同时内核、系统相关的模块及部分驱动会被写到磁盘文件中，机箱断电后由硬盘启动，直接将这里的内容写回内存，从而提高系统启动速度。完全休眠包含大量正在由应用程序使用的内存页，相比之下内核会话休眠数据要小得多，这将大大降低写入磁盘所需的时间。建议关闭该特性的原因是，“快速启动” 会影响 Grub 开机引导过程，可能出现无法载入 Ubuntu 的状况。</p><p>按如下操作取消快速启动：</p><p><strong>电源选项 &gt; 选择电源按钮的功能 &gt; 更改当前不可用的设置 &gt; 关机设置 &gt; [取消勾选] 启用快速启动 &gt; 保存修改</strong></p><h3 id="2-禁用安全启动（Secure-Boot）"><a href="#2-禁用安全启动（Secure-Boot）" class="headerlink" title="2. 禁用安全启动（Secure Boot）"></a>2. 禁用安全启动（Secure Boot）</h3><p>UEFI 有 “安全启动” 这个特点，引导程序只会启动那些得到 UEFI 固件签署的引导装载程序。此安全功能可以防止 Rootkit 类的恶意软件，并提供了额外的安全层。但它有一个缺点，如果你想在 Win 10 的电脑上双引导 Linux ，安全机制会阻止这样做。这里告诉大家如何在 Win 10 中禁用 UEFI 安全引导，以支持 Linux 的双系统启动。</p><p>虽然在 BIOS 时代，访问 BIOS 是相当简单的，在启动的时候按 F10 或 F12 键即可。但是在 UEFI 的世界里，有一些不一样，某些品牌电脑支持类似 BIOS 的访问启动访问键。要访问 UEFI 设置，你也可以通过 Windows 进入 ＵUEFI 设置界面。让我们来看看如何在 Win 10 中访问 UEFI 设置来禁用安全启动。</p><p>按如下步骤操作：</p><p><strong>开始菜单 &gt; 设置 &gt; 更新和安全 &gt; 恢复 &gt; 高级启动 &gt; 立即重启 &gt; …重启… &gt; 疑难解答 &gt; 高级选项 &gt; 启动设置/UEFI固件设置 &gt; 重新启动 &gt; 进入UEFI 工具界面(类似BIOS) &gt; Boot(启动选项卡) &gt; Security &gt; Secure Boot(安全引导) &gt; 保存并退出</strong></p><p><strong>注意 1</strong>：不同品牌电脑 UEFI 界面会有差异</p><p><strong>注意 2</strong>：安装完双系统，重启后记得进入 BIOS 改回 UEFI Security Boot On 模式，也就是重新开启 Security Boot</p><h3 id="3-硬盘分区"><a href="#3-硬盘分区" class="headerlink" title="3. 硬盘分区"></a>3. 硬盘分区</h3><p>作者本机已有 256G SSD + 8T HDD，其中 SSD 已经装有了 Win10，现在我想分出一部分空间用来装 Ubuntu。因为安装时我手里临时没有 PE 盘，而且 UEFI 也不支持 DISKGENUS 的 DOS 启动模式，所以我用 Win 10 自带分区工具对已有的 Window 系统盘进行分区。不过我建议大家进入 PE 对系统盘进行分区。</p><p>为了直观并加深理解，我们先用 DISKGENIUS 查看一下SSD的分区表：</p><p><img src="839812.PNG" alt="图1 SSD 分区，MSR分区是微软保留分区"></p><p>上图表示的是我安装 Linux 后的 SSD 硬盘分区表，我们可以看到硬盘从起始柱面开始有个 500MB 的 ESP 分区，它全名叫 EFI system partition，简写为 ESP 。这个分区就是各个操作系统引导文件放置的地方，电脑启动后主板上的 UEFI 模块会读取每个硬盘的第一个 FAT 分区，如果分区内有 EFI 这个文件目录，就根据 EFI 文件目录的引导文件加载各类型的驱动和引导文件，启动系统同时完成自检。如果第一个 FAT 分区没有 EFI 则选第二个，如果第一块盘没有则选第二块盘，以此类推。</p><p>ESP 分区里的 EFI 文件夹如下图所示：</p><p><img src="54215c80c7480dc967d4ea52d38fce67.PNG" alt="图2 EFI 文件夹"></p><p><img src="207db79f9b601038a1d0b557979e7612.PNG" alt="图3 启动引导文件"></p><p>也许有人问，要是把 Ubuntu 安装到非 Windows 系统盘的另外一个盘会怎么样，这取决与你 UEFI 设置中的启动顺序。</p><h2 id="二、Linux-以Ubuntu为例-安装"><a href="#二、Linux-以Ubuntu为例-安装" class="headerlink" title="二、Linux (以Ubuntu为例) 安装"></a>二、Linux (以Ubuntu为例) 安装</h2><h3 id="1-从-Windows-制作启动U盘"><a href="#1-从-Windows-制作启动U盘" class="headerlink" title="1. 从 Windows 制作启动U盘"></a>1. 从 Windows 制作启动U盘</h3><p>访问 Ubuntu 的 <a href="http://www.ubuntu.com/download">官方下载</a> 页面，选择相应版本。一般而言它的版本有桌面版，服务器版，32位，64位，LTS，非 LTS 之分。所谓 LTS（Long Term Support）指的是长时间支持版本，并不是每一个新版本的 Ubuntu 都是 LTS 版本，譬如，最新的 12.10 版本就不是 LTS 版本，12.04 就是 LTS 版本，12.04 之前的 LTS 版本要追溯到2010年4月发布的 10.04，同时主版本号代表发布的年份，次版本号代表发布的月份，例如：12.04表示2012年4月发布。一般来说，推荐下载最近的 LTS 版本会得到更好的官方支援。这里我们推荐安装 12.04 的64位桌面版（命名方式：ubuntu-12.04.1-desktop-amd64.iso），官方支持长达5年之久，基本上已经超过了用户当前硬件的预期使用寿命，也就是说你在换下一台PC之前无需更换操作系统。如果官方站点的下载速度较慢，你也可以搜索国内的一些镜像网站加速下载过程。譬如 <a href="http://mirrors.163.com/ubuntu-releases/precise/">网易镜像</a></p><blockquote><p>AMD64是64位系统的代号，因为AMD率先开发了64位的技术。现在所有的桌面系统的64位处理器统称为AMD64处理器，无论是intel的还是AMD的，所以下载Ubuntu_AMD64可以在Intel和AMD上同时使用，没有问题的。</p></blockquote><p>在 Windows 下访问 <a href="http://www.pendrivelinux.com/universal-usb-installer-easy-as-1-2-3/">Universal USB Installer</a> 的主页，这个Ubuntu官方推荐的绿色小工具就是帮助用户在手头没有 Ubuntu 的情况下，使用 Windows 来制作启动U盘。这个页面不仅包括了工具的下载链接，同时也包含了详细的操作步骤，同学们准备好1G容量以上的U盘和刚才下载到的ISO文件，按部就班操作即可，制作U盘的时候注意相应的选项。</p><h3 id="2-Ubuntu-安装注意事项"><a href="#2-Ubuntu-安装注意事项" class="headerlink" title="2. Ubuntu 安装注意事项"></a>2. Ubuntu 安装注意事项</h3><p>如果电脑支持 UEFI (Win8以上都支持)，不需要用工具特意添加启动项，只需要在 Unbutu 分区的时候，<strong>将启动引导器设置为 esp 分区</strong>(EFI system partition)。当然前提是你安装的 Linux 发行版支持 uefi，这很好辨认，用压缩工具打开 Linux 镜像，里边有一个 efi 的文件夹就是支持。</p><p><img src="cc08d2558e8f1980be4e1987aca3cc0b.png" alt="图4 Ubuntu安装启动引导器"></p><p><img src="652eafee566c3f744358007196b4dba6.PNG" alt="图5 ESP分区挂载"></p><blockquote><p>进入 ubuntu 之后在终端输入 df 命令，你会发现 esp 分区被挂载到了 <code>/boot/efi</code> 下</p></blockquote><p>用 grub2 引导 Windows 容易，但目前网上还找不到用 Windows Boot Manager 来引导 Linux 的方案。其实在 uefi+gpt 模式下，可以在主板中选择系统启动顺序，就像设置U盘光驱启动顺序一样，如果设置 windows boot manager 为第一启动，那么开机时直接进入 windows 系统，就跟只安装了 windows 单系统时一样；如果设置 ubuntu 为第一启动，开机时会进入 grub 菜单界面，可以选择 ubuntu 或 windows 系统。</p><p>如果你嫌grub2引导界面太丑，我们还有一个方案：用 rEFind 管理所有启动引导程序。</p><h3 id="3-交换空间大小设置"><a href="#3-交换空间大小设置" class="headerlink" title="3. 交换空间大小设置"></a>3. 交换空间大小设置</h3><p>推荐按照下表设置交换空间大小：</p><table><thead><tr><th>RAM 大小</th><th>推荐的交换空间</th></tr></thead><tbody><tr><td>小于或等于 2GB</td><td>2 倍 RAM</td></tr><tr><td>2 GB ~ 8 GB</td><td>等于 RAM 大小</td></tr><tr><td>大于 8GB</td><td>8 GB</td></tr></tbody></table><h2 id="三、rEFInd-管理启动引导"><a href="#三、rEFInd-管理启动引导" class="headerlink" title="三、rEFInd 管理启动引导"></a>三、rEFInd 管理启动引导</h2><h3 id="1-完整备份EFI文件夹"><a href="#1-完整备份EFI文件夹" class="headerlink" title="1. 完整备份EFI文件夹"></a>1. 完整备份EFI文件夹</h3><p>在 PE 中或者用 DISKGENIUS 打开 ESP 分区，将 EFI 文件夹及内容完整备份到你认为安全的地方。目录结构大致如下：</p><pre><code>/efi/boot/efi/Microsoft/efi/Unbuntu/efi/refind</code></pre><h3 id="2-安装-rEFInd"><a href="#2-安装-rEFInd" class="headerlink" title="2. 安装 rEFInd"></a>2. 安装 rEFInd</h3><p>rEFInd官网：<a href="http://www.rodsbooks.com/refind/">http://www.rodsbooks.com/refind/</a></p><p>下载地址：<a href="http://www.rodsbooks.com/refind/getting.html">http://www.rodsbooks.com/refind/getting.html</a></p><p>对于大多数 Linux 用户来说， RPM 或 Debian 软件包是最好的选择。但是，如果您的 Linux 系统不支持这些格式，或者如果您运行的是 OS X，那么使用 refind-install 脚本可能是一个好方法。如果您使用 Windows ，则必须手动安装。</p><h4 id="Linux-下安装"><a href="#Linux-下安装" class="headerlink" title="Linux 下安装"></a>Linux 下安装</h4><p>Linux 下安装 rEFInd 十分简便，只需要一条命令。首先在官网上下载 <code>A binary zip file</code>，完成后将 refind-bin-0.10.8 解压，进入解压出的文件夹，运行下列命令</p><pre><code>sudo bash refind-install</code></pre><p>然后切换 root 权限进入 <code>/boot/efi/EFI/refind/</code> ，重命名 <code>refind.conf-sample</code> 为 <code>refind.conf</code> 。</p><h4 id="Windows-下手动安装"><a href="#Windows-下手动安装" class="headerlink" title="Windows 下手动安装"></a>Windows 下手动安装</h4><p>Windows 下的 rEFInd 安装十分繁琐费劲。首先用 DISKGENIUS 为 ESP 指派新的驱动器号，然后进入 ESP 并打开 EFI 文件夹，新建 rEFInd 文件夹，将下载好的 refind.zip 解压，仿照 refind.conf-sample 新建一个 refind.conf 文件。将解压的文件夹和文件逐个放入 ESP 分区中的 efi/rEFInd 文件夹里，值得注意的是通过 DISKGENIUS 拷贝文件夹只能挨个新建。</p><h3 id="3-使用-BOOTICE-工具修改-UEFI-启动序列"><a href="#3-使用-BOOTICE-工具修改-UEFI-启动序列" class="headerlink" title="3. 使用 BOOTICE 工具修改 UEFI 启动序列"></a>3. 使用 BOOTICE 工具修改 UEFI 启动序列</h3><p>根据 Windows 版本选择下载 BOOTICE 工具，打开工具后：</p><p><strong>选择 UEFI 选项卡 &gt; 修改启动序列 &gt; 点击添加 &gt;  找到你新建的 rEFInd 文件夹 &gt; 选择 refind_x64.eif (或者 refind_ia32.efi) &gt; 提示成功后修改菜单标题为 rEFInd &gt; 将该 rEFInd 上移到最顶端 &gt; 点击保存当前启动设置 &gt; 关闭工具并重启计算机</strong></p><h3 id="4-修改-rEFInd-配置"><a href="#4-修改-rEFInd-配置" class="headerlink" title="4. 修改 rEFInd 配置"></a>4. 修改 rEFInd 配置</h3><h4 id="配置文件"><a href="#配置文件" class="headerlink" title="配置文件"></a>配置文件</h4><p>默认扫描设置会将 Linux 内核以及 Window Boot Manager 显示在引导界面，为了屏蔽这些不需要的启动项，可以如下设置：</p><pre><code>    timeout 设置默认时间20s，时间到后进入默认操作系统。 0表示一直等待选择    screensaver 设置在进入引导前的屏保时间，通常不启用(加#注释掉即可)    hideui 隐藏界面功能选项，可以隐藏的选项有：        banner eEFInd标识图 -&gt;自己决定        label 每个标签的文字描述以及timeout设置的倒数计时器 -&gt;自己决定        singleuser 苹果系统子菜单中单用户选项 -&gt;不需要显示        safemode 苹果系统子菜单中安全模式选项 -&gt;不需要显示        hwtest Mac硬件测试选项 -&gt;不需要显示        arrows 无法显示所有的引导菜单时的左右指示箭头 -&gt;不需要显示        hints 基本按键的简要说明 -&gt;自己决定        editor 选项编辑器 -&gt;自己决定        or all 隐藏所有选项    icons_dir 指定自定义图标目录    resolution 屏幕分辨率    default_selection 默认进入的系统选项    include 引导界面美化常用    dont_scan_dirs, dont_scan_files, dont_scan_volumes 设置引导器过滤那些目录、文件、卷类型（分区）</code></pre><h3 id="5-推荐主题"><a href="#5-推荐主题" class="headerlink" title="5. 推荐主题"></a>5. 推荐主题</h3><p><a href="https://github.com/EvanPurkhiser/rEFInd-minimal">https://github.com/EvanPurkhiser/rEFInd-minimal</a></p><p><img src="687474703a2f2f692e696d6775722e636f6d2f33624d473655372e706e67.png" alt="图6 rEFInd-minimal 主题"></p><h2 id="四、问题与解决方案"><a href="#四、问题与解决方案" class="headerlink" title="四、问题与解决方案"></a>四、问题与解决方案</h2><h3 id="用-bootice-修复-MBR-引导问题"><a href="#用-bootice-修复-MBR-引导问题" class="headerlink" title="用 bootice 修复 MBR 引导问题"></a>用 bootice 修复 MBR 引导问题</h3><ol><li><p>在bootice界面中，首先选择“目标磁盘”，然后再点击“主引导记录(M)”。</p></li><li><p>在弹出的窗口中先点击“windows NT5.x/6.x MBR”，后点击“安装/配置”按钮。</p></li><li><p>在弹出的窗口中选择对应的类型。(win7的选择Windows NT 6.x，WinXP的选择Windows NT 5.x)</p></li><li><p>然后回到bootice主界面，保持目标磁盘不变，这次点击“分区引导记录(P)”</p></li><li><p>然后在弹出的窗口中选择要更改的类型，win7用户选择“bootmgr引导程序”。Win xp用户选择“NTLDR引导程序”，选择后点击“安装/配置”。</p></li><li><p>这时会弹出“引导文件重命名”窗口，对于里面的内容不做修改，直接点击“确定”就行了。</p></li></ol><h3 id="用-bootice-编辑或修复-BCD-引导"><a href="#用-bootice-编辑或修复-BCD-引导" class="headerlink" title="用 bootice 编辑或修复 BCD 引导"></a>用 bootice 编辑或修复 BCD 引导</h3><ol><li><p>打开BOOTICE，选择BCD编辑。</p></li><li><p>找到C盘里Microsoft文件夹下的Boot文件夹，选择里面的BCD文件。</p></li><li><p>选择好之后选择智能编辑模式，只要理解了启动盘和启动分区的概念就能轻松修复 Windows 引导。</p></li></ol><h2 id="五、参考资料"><a href="#五、参考资料" class="headerlink" title="五、参考资料:"></a>五、参考资料:</h2><ol><li><p>如何在 Win8 上禁用 UEFI 安全引导以安装Linux</p><p> <a href="https://linux.cn/article-3061-1.html">https://linux.cn/article-3061-1.html</a></p></li><li><p>硬件大讲堂：MBR和GPT分区表的那些事儿</p><p> <a href="http://diy.zol.com.cn/608/6088274.html">http://diy.zol.com.cn/608/6088274.html</a></p></li><li><p>西瓜君教你一步一步安装单硬盘Win8.1+Ubuntu双系统（UEFI篇）</p><p> <a href="http://tieba.baidu.com/p/3338849023?red_tag=x0132009230">http://tieba.baidu.com/p/3338849023?red_tag=x0132009230</a></p></li><li><p>Ubuntu桌面生存指南 (3) — 构建Ubuntu系统基础设施</p><p> <a href="http://ghosertblog.github.io/blog/2012/10/30/ubuntu-living-handbook-install/">http://ghosertblog.github.io/blog/2012/10/30/ubuntu-living-handbook-install/</a></p></li></ol>]]></content>
    
    
    <summary type="html">&lt;p&gt;此文最早由我在&lt;a href=&quot;https://www.jianshu.com/p/90dca469e8f8&quot;&gt;简书&lt;/a&gt;发表，现搬运到本人博客。&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;写这篇文章的初衷在于网络上关于 Windows 和 Linux 双系统的安装大多停留在 BIOS/MBR 时代，而现在计算主板主要为 UEFI/GPT 的架构。本文假设读者已经重装过几次 Windows 系统，对计算机基础知识有一定了解，知道如何进入 BIOS，知道如何对硬盘进行分区。如果在阅读本文过程中遇到不太熟悉的概念，请务必先自行搜索并查阅相关资料。本文不提供 Win10 安装方法，以下内容默认用户电脑已安装 Win10 系统。&lt;/p&gt;
&lt;/blockquote&gt;
&lt;h2 id=&quot;一、Win10-准备工作&quot;&gt;&lt;a href=&quot;#一、Win10-准备工作&quot; class=&quot;headerlink&quot; title=&quot;一、Win10 准备工作&quot;&gt;&lt;/a&gt;一、Win10 准备工作&lt;/h2&gt;&lt;h3 id=&quot;1-禁用快速启动&quot;&gt;&lt;a href=&quot;#1-禁用快速启动&quot; class=&quot;headerlink&quot; title=&quot;1. 禁用快速启动&quot;&gt;&lt;/a&gt;1. 禁用快速启动&lt;/h3&gt;&lt;p&gt;“快速启动” 是 Windows 8 时代引进的新特性，快速启动会关闭用户会话，但不再关闭内核会话，而是将其休眠。关机后部分系统数据以低电压加载至内存，开机时直接从内存调用。同时内核、系统相关的模块及部分驱动会被写到磁盘文件中，机箱断电后由硬盘启动，直接将这里的内容写回内存，从而提高系统启动速度。完全休眠包含大量正在由应用程序使用的内存页，相比之下内核会话休眠数据要小得多，这将大大降低写入磁盘所需的时间。建议关闭该特性的原因是，“快速启动” 会影响 Grub 开机引导过程，可能出现无法载入 Ubuntu 的状况。&lt;/p&gt;
&lt;p&gt;按如下操作取消快速启动：&lt;/p&gt;
&lt;p&gt;&lt;strong&gt;电源选项 &amp;gt; 选择电源按钮的功能 &amp;gt; 更改当前不可用的设置 &amp;gt; 关机设置 &amp;gt; [取消勾选] 启用快速启动 &amp;gt; 保存修改&lt;/strong&gt;&lt;/p&gt;
&lt;h3 id=&quot;2-禁用安全启动（Secure-Boot）&quot;&gt;&lt;a href=&quot;#2-禁用安全启动（Secure-Boot）&quot; class=&quot;headerlink&quot; title=&quot;2. 禁用安全启动（Secure Boot）&quot;&gt;&lt;/a&gt;2. 禁用安全启动（Secure Boot）&lt;/h3&gt;&lt;p&gt;UEFI 有 “安全启动” 这个特点，引导程序只会启动那些得到 UEFI 固件签署的引导装载程序。此安全功能可以防止 Rootkit 类的恶意软件，并提供了额外的安全层。但它有一个缺点，如果你想在 Win 10 的电脑上双引导 Linux ，安全机制会阻止这样做。这里告诉大家如何在 Win 10 中禁用 UEFI 安全引导，以支持 Linux 的双系统启动。&lt;/p&gt;
&lt;p&gt;虽然在 BIOS 时代，访问 BIOS 是相当简单的，在启动的时候按 F10 或 F12 键即可。但是在 UEFI 的世界里，有一些不一样，某些品牌电脑支持类似 BIOS 的访问启动访问键。要访问 UEFI 设置，你也可以通过 Windows 进入 ＵUEFI 设置界面。让我们来看看如何在 Win 10 中访问 UEFI 设置来禁用安全启动。&lt;/p&gt;</summary>
    
    
    
    <category term="Linux" scheme="https://www.altairwei.top/categories/Linux/"/>
    
    
  </entry>
  
</feed>
